[[automations]]
name = "secret-scan-on-file-save"
description = "Scan for accidental secrets when any file is saved"
trigger = { type = "file_saved", pattern = "*" }
action = { type = "shell", command = "grep -r --include='*.{js,ts,py,rs,go,dart,env}' -E '(sk-[a-zA-Z0-9]{48}|ghp_[a-zA-Z0-9]{36}|AKIA[A-Z0-9]{16}|password\\s*=\\s*[\"'\''][^\"'\'']{8,})' . 2>/dev/null | grep -v '.git' | head -5" }
on_output = { notify = "Potential secret detected in modified files â€” check output" }
enabled = true
