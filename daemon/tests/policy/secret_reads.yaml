# Sprint ZZ PT.T05 â€” Secret read policy tests
# Tests that reading sensitive credential files is denied.
name: secret_reads

cases:
  - command: Read
    args:
      file_path: "/etc/passwd"
    expected: deny
    reason: Reading system password file
    category: secret_read

  - command: Read
    args:
      file_path: "~/.ssh/id_rsa"
    expected: deny
    reason: Reading private SSH key
    category: secret_read

  - command: Read
    args:
      file_path: "~/.aws/credentials"
    expected: deny
    reason: Reading AWS credentials
    category: secret_read

  - command: Bash
    args:
      command: "cat ~/.claude/vault.env"
    expected: deny
    reason: Reading credentials vault
    category: secret_read

  - command: Bash
    args:
      command: "env | grep -i secret"
    expected: deny
    reason: Extracting secrets from environment
    category: secret_read

  - command: Read
    args:
      file_path: "src/README.md"
    expected: allow
    reason: Reading a non-sensitive documentation file
    category: safe_read
